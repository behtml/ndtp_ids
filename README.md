# NDTP IDS - Network Data Traffic Processing Intrusion Detection System

## Описание

NDTP IDS - это система обнаружения вторжений, основанная на анализе сетевого трафика. Проект включает модуль коллектора пакетов, который перехватывает и обрабатывает сетевой трафик.

## Коллектор пакетов

Коллектор пакетов — это модуль, который:
- Перехватывает сетевой трафик
- Извлекает метаданные (НЕ payload)
- Приводит данные к нормализованному формату
- Передаёт их дальше (в агрегатор)

### Возможности

- Захват пакетов с сетевого интерфейса в реальном времени
- Извлечение метаданных: IP-адреса, порты, протоколы (TCP/UDP)
- Определение направления трафика (входящий/исходящий)
- Нормализация данных в формат JSON
- Поддержка различных сетевых интерфейсов

### Установка

```bash
# Клонирование репозитория
git clone https://github.com/behtml/ndtp_ids.git
cd ndtp_ids

# Установка зависимостей
pip install -r requirements.txt

# Или установка пакета
pip install -e .
```

### Использование

```python
from ndtp_ids.packet_collector import start_collector

# Запуск коллектора на интерфейсе eth0
start_collector(interface="eth0")
```

Или запуск напрямую:

```bash
python -m src.ndtp_ids.packet_collector
```

### Конфигурация

Вы можете настроить префикс локальной сети в файле `packet_collector.py`:

```python
LOCAL_NET_PREFIX = "192.168."  # измените под вашу сеть
```

### Формат данных

Коллектор генерирует события в формате JSON:

```json
{
    "timestamp": 1707646800.123456,
    "src_ip": "192.168.1.100",
    "dst_ip": "8.8.8.8",
    "src_port": 54321,
    "dst_port": 443,
    "protocol": "TCP",
    "packet_size": 1500,
    "direction": "out"
}
```

### Требования

- Python >= 3.10
- Scapy >= 2.5.0
- Права администратора/root для захвата пакетов

### Примеры интерфейсов

- **Linux**: `eth0`, `wlan0`, `enp0s3`
- **Windows**: `"Ethernet"`, `"Wi-Fi"`
- **macOS**: `en0`, `en1`

## Архитектура

```
┌──────────────────┐
│  Сетевой трафик  │
└────────┬─────────┘
         │
         v
┌──────────────────┐
│ Packet Collector │ ← Этот модуль
│  (Коллектор)     │
└────────┬─────────┘
         │
         v
┌──────────────────┐
│   Агрегатор      │ (будущая разработка)
└──────────────────┘
```

## Лицензия

MIT License