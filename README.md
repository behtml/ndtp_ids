# NDTP IDS - Network Data Traffic Processing Intrusion Detection System

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

**NDTP IDS** - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Ç–æ—Ä–∂–µ–Ω–∏–π (IDS), –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –∞–Ω–æ–º–∞–ª–∏–π. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö —Å–µ—Ç–µ–π.

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–ö–æ–ª–ª–µ–∫—Ç–æ—Ä –ø–∞–∫–µ—Ç–æ–≤** - –∑–∞—Ö–≤–∞—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
2. **–ê–≥—Ä–µ–≥–∞—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫–Ω–∞–º –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
3. **–î–µ—Ç–µ–∫—Ç–æ—Ä –∞–Ω–æ–º–∞–ª–∏–π** - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ z-score –º–µ—Ç–æ–¥–∞
4. **üÜï –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - Flask-based dashboard –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
5. **üÜï –ü—Ä–∞–≤–∏–ª–∞ Suricata** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏
6. **üÜï –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ baseline —Å EWMA –∏ —Å–∫–æ–ª—å–∑—è—â–∏–º–∏ –æ–∫–Ω–∞–º–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Packet Collector ‚îÇ ‚Üê –ó–∞—Ö–≤–∞—Ç –ø–∞–∫–µ—Ç–æ–≤ (Scapy)
‚îÇ  (–ö–æ–ª–ª–µ–∫—Ç–æ—Ä)     ‚îÇ   –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ JSON
         ‚îÇ             
         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ              v
         ‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ         ‚îÇ Suricata Rules   ‚îÇ ‚Üê üÜï –°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑
         ‚îÇ         ‚îÇ    Parser        ‚îÇ   –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª
         ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Aggregator     ‚îÇ ‚Üê –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞ (10 –º–∏–Ω)
‚îÇ   (–ê–≥—Ä–µ–≥–∞—Ç–æ—Ä)    ‚îÇ   –ü–æ–¥—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ SQLite
         ‚îÇ
         v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Adaptive Trainer ‚îÇ ‚Üê üÜï –û–±—É—á–µ–Ω–∏–µ baseline
‚îÇ   (–¢—Ä–µ–Ω–µ—Ä)       ‚îÇ   EWMA —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
         ‚îÇ
         v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Anomaly Detector ‚îÇ ‚Üê Z-score –∞–Ω–∞–ª–∏–∑
‚îÇ   (–î–µ—Ç–µ–∫—Ç–æ—Ä)     ‚îÇ   –ì–∏–±—Ä–∏–¥–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤
         ‚îÇ
         v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Web Interface    ‚îÇ ‚Üê üÜï Dashboard & API
‚îÇ   (Flask)        ‚îÇ   –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python >= 3.10
- –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞/root –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –ø–∞–∫–µ—Ç–æ–≤
- Linux/Windows/macOS

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/behtml/ndtp_ids.git
cd ndtp_ids

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -e .
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `scapy>=2.5.0` - –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- `flask>=3.0.0` - –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ö–æ–ª–ª–µ–∫—Ç–æ—Ä –ø–∞–∫–µ—Ç–æ–≤ (Packet Collector)

–ö–æ–ª–ª–µ–∫—Ç–æ—Ä –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–±–µ–∑ payload –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏).

**–ó–∞–ø—É—Å–∫ –Ω–∞–ø—Ä—è–º—É—é:**

```bash
python -m ndtp_ids.packet_collector
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:**

```python
from ndtp_ids.packet_collector import start_collector

# –ó–∞–ø—É—Å–∫ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ eth0
start_collector(interface="eth0")
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

–í —Ñ–∞–π–ª–µ `src/ndtp_ids/packet_collector.py` –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–µ—Ñ–∏–∫—Å –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏:

```python
LOCAL_NET_PREFIX = "192.168."  # –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ–¥ –≤–∞—à—É —Å–µ—Ç—å
```

**–ü—Ä–∏–º–µ—Ä—ã —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤:**
- **Linux**: `eth0`, `wlan0`, `enp0s3`
- **Windows**: `"Ethernet"`, `"Wi-Fi"`
- **macOS**: `en0`, `en1`

**–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (JSON):**

```json
{
    "timestamp": 1707646800.123456,
    "src_ip": "192.168.1.100",
    "dst_ip": "8.8.8.8",
    "src_port": 54321,
    "dst_port": 443,
    "protocol": "TCP",
    "packet_size": 1500,
    "direction": "out"
}
```

### 2. –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫ (Aggregator)

–ê–≥—Ä–µ–≥–∞—Ç–æ—Ä —Å–æ–±–∏—Ä–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞, –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –∏—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫–Ω–∞–º –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏.

**–ó–∞–ø—É—Å–∫ (—á–∏—Ç–∞–µ—Ç JSON –∏–∑ stdin):**

```bash
# –ó–∞–ø—É—Å–∫ —Å –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–æ–º —á–µ—Ä–µ–∑ pipe
python -m ndtp_ids.packet_collector | python -m ndtp_ids.aggregator
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:**

```bash
python -m ndtp_ids.aggregator --db ndtp_ids.db --window 10
```

- `--db` - –ø—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `ndtp_ids.db`)
- `--window` - —Ä–∞–∑–º–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10)

**–í—ã—á–∏—Å–ª—è–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (connections_count)
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (unique_ports)
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ IP –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (unique_dst_ips)
- –û–±—â–∏–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–π—Ç–∞—Ö (total_bytes)
- –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ (avg_packet_size)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:**

```python
from ndtp_ids.aggregator import MetricsAggregator

aggregator = MetricsAggregator(db_path="ndtp_ids.db", window_minutes=10)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è
event = {
    "timestamp": 1707646800.123456,
    "src_ip": "192.168.1.100",
    "dst_ip": "8.8.8.8",
    "src_port": 54321,
    "dst_port": 443,
    "protocol": "TCP",
    "packet_size": 1500,
    "direction": "out"
}
aggregator.process_event(event)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
metrics = aggregator.get_metrics(src_ip="192.168.1.100", limit=10)
```

### 3. –î–µ—Ç–µ–∫—Ç–æ—Ä –∞–Ω–æ–º–∞–ª–∏–π (Anomaly Detector)

–î–µ—Ç–µ–∫—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ z-score –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –≤ —Å–µ—Ç–∏.

**–ó–∞–ø—É—Å–∫:**

```bash
python -m ndtp_ids.anomaly_detector --threshold 3.0 --interval 60
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--db` - –ø—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `ndtp_ids.db`)
- `--threshold` - –ø–æ—Ä–æ–≥ z-score –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3.0)
- `--interval` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 60)

**–£—Ä–æ–≤–Ω–∏ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏ –∞–ª–µ—Ä—Ç–æ–≤:**
- `low` - z-score < 3.0
- `medium` - z-score >= 3.0
- `high` - z-score >= 4.0
- `critical` - z-score >= 5.0

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:**

```python
from ndtp_ids.anomaly_detector import AnomalyDetector

detector = AnomalyDetector(db_path="ndtp_ids.db", z_threshold=3.0)

# –ó–∞–ø—É—Å–∫ –¥–µ—Ç–µ–∫—Ü–∏–∏
detector.run_detection()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
alerts = detector.get_recent_alerts(limit=10, severity="high")
```

### 4. –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–µ:

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ö–æ–ª–ª–µ–∫—Ç–æ—Ä + –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä
python -m ndtp_ids.packet_collector | python -m ndtp_ids.aggregator --window 1

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –î–µ—Ç–µ–∫—Ç–æ—Ä –∞–Ω–æ–º–∞–ª–∏–π
python -m ndtp_ids.anomaly_detector --interval 30 --threshold 3.0

# –¢–µ—Ä–º–∏–Ω–∞–ª 3: üÜï –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
python -m ndtp_ids.web_interface --port 5000
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```

### 5. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

–í –ø–∞–ø–∫–µ `examples/` –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–º–æ:

```bash
# –ë–∞–∑–æ–≤–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
python examples/demo.py

# üÜï –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
python examples/integrated_demo.py
# –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É Suricata –ø—Ä–∞–≤–∏–ª, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –≥–∏–±—Ä–∏–¥–Ω–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏
```

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ë–∞–∑–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:

### –¢–∞–±–ª–∏—Ü–∞ `raw_events`
–°—ã—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤

### –¢–∞–±–ª–∏—Ü–∞ `aggregated_metrics`
–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫–Ω–∞–º

### –¢–∞–±–ª–∏—Ü–∞ `alerts`
–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏ –∏ –∞–ª–µ—Ä—Ç—ã

### –¢–∞–±–ª–∏—Ü–∞ `host_profiles`
–ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ —Ö–æ—Å—Ç–æ–≤ (—Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è)

## üî¨ –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π

### Z-Score –º–µ—Ç–æ–¥

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç z-score (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ) –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π:

```
z-score = |X - Œº| / œÉ

–≥–¥–µ:
X - —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏
Œº - —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –Ω–∞–±–ª—é–¥–µ–Ω–∏–π
œÉ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ–º—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏:**
- –í—Å–ø–ª–µ—Å–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–≤–æ–∑–º–æ–∂–Ω–∞—è DDoS-–∞—Ç–∞–∫–∞)
- –ù–µ–æ–±—ã—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ (port scanning)
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏)
- –ê–Ω–æ–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (data exfiltration)

## üéì –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ —É—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è:
- –ò–∑—É—á–µ–Ω–∏—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —Ä–∞–±–æ—Ç—ã IDS
- –ü–æ–Ω–∏–º–∞–Ω–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- –ü—Ä–∞–∫—Ç–∏–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–∏—Å—Ç–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **üÜï –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω–æ–≥–æ –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞**
- **üÜï –ò–∑—É—á–µ–Ω–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤ –ò–ë**
- **üÜï –°–æ–∑–¥–∞–Ω–∏—è web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**

## üÜï –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **Dashboard** - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Å–æ–±—ã—Ç–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–•–æ—Å—Ç—ã** - —Å–ø–∏—Å–æ–∫ –∏ –ø—Ä–æ—Ñ–∏–ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–ê–ª–µ—Ä—Ç—ã** - –∏—Å—Ç–æ—Ä–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –∞–Ω–æ–º–∞–ª–∏–π
- **–ü—Ä–∞–≤–∏–ª–∞ Suricata** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏
- **–û–±—É—á–µ–Ω–∏–µ** - –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ–∂–∏–º–∞ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ö–æ—Å—Ç–∞

### –ì–∏–±—Ä–∏–¥–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è (Suricata + Behavioral)
–°–∏—Å—Ç–µ–º–∞ —Å–æ—á–µ—Ç–∞–µ—Ç –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:
1. **–°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑** (Suricata) - –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∞—Ç–∞–∫–∏
2. **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** - –∞–Ω–æ–º–∞–ª–∏–∏ –∏ zero-day —É–≥—Ä–æ–∑—ã

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º** - —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ
- **EWMA —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ** - –ø–ª–∞–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º
- **–°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ** - —É—á–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏—è** - –∞–Ω–æ–º–∞–ª–∏–∏ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ baseline

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[WEB_INTERFACE_GUIDE.md](WEB_INTERFACE_GUIDE.md)** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
- **[TRAINING_QUICKSTART.md](TRAINING_QUICKSTART.md)** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∏ –æ–±—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- **[IMPLEMENTATION_RU.md](IMPLEMENTATION_RU.md)** - –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **[QUICK_START_RU.md](QUICK_START_RU.md)** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ö–æ–ª–ª–µ–∫—Ç–æ—Ä –ù–ï —Å–æ–±–∏—Ä–∞–µ—Ç payload –ø–∞–∫–µ—Ç–æ–≤ - —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
2. **–ü—Ä–∞–≤–∞**: –î–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –ø–∞–∫–µ—Ç–æ–≤ —Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. **–õ–µ–≥–∞–ª—å–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –≤ —Å–≤–æ–∏—Ö —Å–µ—Ç—è—Ö –∏–ª–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ù–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë• –ê–≤—Ç–æ—Ä—ã

NDTP IDS Team

## üîó –°—Å—ã–ª–∫–∏

- Repository: https://github.com/behtml/ndtp_ids